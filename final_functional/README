Final functional version of cache prior to extra credit optimizations
